# Фронтенд

---

## 1. Фронтенд - ***Диспетчер*** (Desktop)

* **Данные**
    * Обмен с бэкендом на именованных событиях (Inf, Rec, ReqCon, ReqErr, Cmd, CmdCon, CmdErr)
    * Реконнект - автоматический, обновление ***Статуса***
* **Пользователи**
    * Авторизация
    * Регистрация нового пользователя
    * Управление пользователями
* **Page | Главный экран**
    * **Оборудование** (Дерево на панели слева)
        * Узел дерева
            * Статус (Обобщает Статус Виброаналитики, износа, ТО)
                * Red icon - Alarm (красный)
                * Warning icon<span> - </span>Warning (желтый)
                * ⏰ - Просрочка ТО
            * Наименование
        * Узел дерева можно добавить в Работе -> Закупка
    * **Мониторинг** **оборудования** (Центральная часть -> Вкладка ***Мониторинг***)
        * Сделать неактивной если нечего показать
        * Параметры текущего режима работы, если есть 
        * Информация по износу и виброаналитике, если есть
    * **Характеристики оборудования** (Центральная часть -> Вкладка ***Характеристики***)
        * Список полей (ключ - значение), как вариант можно отобразить в таблице
            * Ключ - уникальный для одного узла, отображдаемый текст и перевод формируются из ключа и храняться в БД в таблице переводов
            * Типв значений - хранится в БД вместе со значением
        * Таблицы
        * Редактирование при наличии прав 
    * **Документы** (Центральная часть -> Вкладка ***Документы***)
        * Список приложенных документов
        * Просмотр выбранного (HTML - в окне приложения / PDF - желательно во встоенном PDF-viewer)
        * Добавление документа
        * Удаление документа
    * **Графики ТО** (список) (Центральная часть -> Вкладка Сервис)
        * Отображение работ в таблице (видны только корневые задачи, вложенные можно открыть по клику в отдельном окне ***Навигатор-Редактор Работ***)
            * Фильтр "На Сегодня":
                * Работы ***Planned*** на сегодня
            * Фильтр "По умолчанию" :
                * Сначала ***Просроченные*** работы с иконкой ⏰
                * Потом ***InProgress***, ***Paused***, ***Confirmation***
                * Ниже работы ***Planned***
                    * 5..1 дней до ***Просрочки***  - подсветить цветом Warning
            * Фильтр по статусу, по флагам, по исполнителю
        * Добавление работ (отобразить вложенным списком)
            * Добавление Работ из списка Видов работ
            * Кастомизация списка работ (***Редактор Работ***)
            * На конкретную дату или с периодичностью 
            * Можно назначить исполнителя
        * Ведение работ
            * Показать работу вложенным списком (treeview)
            * Можно назначить исполнителя
            * Можно изменить статус
                * При Отмене запросить комментарий
                * При Завершении запросить отчет
                    * Описание - текст
                    * Приложить файл (Изображение / документ)
            * Можно сформировать Закупку (Список деталей с артикулами и необходимыми для закупки характеристиками)
                * Можно добавить запись сформированную из узла дерева Оборудования, с явным ручным указанием вложенных елементов
                * Можно добавить вручную
                * Статус (Формирование / Отправлено / Закрыто)
                    * <s>Опционально статус можно указать записям закупки (Черновик / Отправлено / Закрыто)</s> - Может быть в будущих версиях
* **Page | 3D View**
    * Обзор модели оборудования
    * Индикачия режима, износа и виброаналитика цветными лампочками рядом с соответствующим узлом оборудования
    * Индикация тревог (иконка, цвет, мерцание)
    * Переход между 3D и деревом: правый клик -> Показать в 3D / Дереве 
* **Widget | Строка состояния** (мини Dashboard)
    * Обновляется в реальном времени
    * Иконки фиксированной ширины (не зависимо от контента)
        * Когда количество 0, поле есть , но пустое, имеет цвет фона, не привлекает внимания
    * Количество активных тревог
        * Warn - желтый
        * Alarm - красный (и возможно мерцает первые N секунда - задать в конфиг файле)
    * Количество просроченных Работ
    * Количество работ на подтверждении
    * Статус связи с бэком
* **Page | Сигнализация**
    * Вкладка События
        * Отображает события в таблице
        * Позволяет фильтровать по
            * По умолчанию последние 24 часа
            * По оборудованию
            * По работе
            * По пользователю
            * По ...
    * Вкладка Аварии
        * Отображает два списка
            * Активные аварии - события, имеющие Класс аварии и имеющие в данный момент логическое значение "1"
                * Сортировать по Классу + дате
            * Пролетевшие аварии события, имеющие Класс аварии и сменившие логическое значение с "1" на "0", но еще не сквитированные
                * Можно сквитировать, тогда они уйдут из списка
* **Page | Список На подтверждение** (Для Инженеров)
    * Окно открывается кликом по иконке в стоке статуса, Иконка "горит" когда в списке есть записи
    * Фильтрация
    * Просмотр отчета перед подтверждением
    * Факт подтверждения логируется в общую историю
* **Widget | Редактор Работ**
    * Форма для редактирования одной записи Работ
    * Нужно определить какие поля доступны в режиме редактирования уже созданных работ
        * Для Статуса Planned: Больше доступно
        * Для остальных статусов: Меньше доступно
* **Page | Навигатор** / Видов работ
    * Показать вложенным списком (treeview)
        * Поиск и(или) фильтр
    * Добавление / Удаление / редактирование полей
    * Дублирование
    * Выбранную работу править в форме ***Редактор Работ***
    * Глубину вложенности ограничить настройкой из конфиг файла (предлагаю 3..5)

---

## 2. Фронтенд - ***Мастер*** (Desktop)

---

## 3. В будущих версиях

* **Фронтенд**
    * **Page | Список На подтверждение** (Для Инженеров)
        * Массовое подтверждение - если будет запрос от заказчика
            * Выбраем несколько на подтверждение
            * Жмем подвердить
            * Очеты работ открываются для просмотра поочередно
                * Есть кнопки Подтвердить / Отклонить
                * Оба варианта требуют комментария
* **Архитектура**
    * **Работа**
        * Зависит от (что бы указать блокирующие задачи)
    * **Закупку** (Список деталей с артикулами и необходимыми для закупки характеристиками)
        * Запись закупки
            * Статус (Формирование / Отправлено / Закрыто) 
    * **Оборудование** (дерево)
        * Перетаскивание узлов дерева (на фронтенде)
        * Сложные связи
            * Дополнительные ссылки (связи с родителями)
            * На фронтенде узел будет виден (в виде ссылки с иконкой и tultip показывает кто Original) во всех узлах куда есть ссылки
            * На логику ссылки не влияют - но это не факт что получится
            * Удаление ссылки - удаленный узел больше не виден в родителе, но остался в фактическом родителе (удаление происходит с уведомлением пользователя об этом)
            * Удаление из фактического родителя приведет к удалению элемента и всех егно ссылок (удаление происходит с уведомлением пользователя об этом)
                * Ссылки можно хранить массивом в записи элемента - тогда процесс удаления проще
            * Вопрос как расчитывать агрегатные значения при наличии ссылки
        * Downtime - допустимое время простоя
        * Статус
            * По умолчанию оборудование имеет статус ***Active***
            * ***Archived*** - не отображаются в дереве оборудования
                * Если оборудование удалено пользователем
                    * Переводим статус удаленного узла и всех дочерних из ***Active*** в ***Archived***
                    * Связанные ***События***, ***Работы*** и ***Отчеты*** - остаются и отображаются
            * **Service** - Вывод в ремонт, ТО
            * **Shutdown** - Останов
