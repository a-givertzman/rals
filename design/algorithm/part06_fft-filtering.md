# **Анализ вибраций двигателя с помощью FFT-фильтрации**

**Анализ вибраций** – ключевой инструмент диагностики механизмов. Для обработки данных в реальном времени используется быстрое преобразование Фурье (FFT), позволяющее выделять значимые изменения и снижать объем хранимой информации.  

FFT-фильтрация упрощает анализ, повышает производительность системы и  детектирует изменения в состоянии двигателя без избыточного хранения данных.

**1. Сбор данных**
- 

Система получает данные от датчиков вибрации двигателя с высокой частотой дискретизации – 300 000 Гц (300 000 точек в секунду), что позволяет фиксировать мельчайшие изменения в работе механизма.

**2. Применение FFT и разбиение на временные окна**
- 

- Данные разбиваются на окна по `30 000 точек`, что соответствует `0.1 секунды` сигнала.

- Анализ выполняется на `10 таких окон подряд`, охватывая в сумме `1 секунду` (300 000 точек).

- К каждому окну применяется быстрое преобразование Фурье (FFT), что позволяет перейти от временного представления к частотному и выделить характерные колебания двигателя.

**3. Фильтрация значимых изменений (Integrated threshold filter)**
-

1. Спектры сравниваются между последовательными окнами.

2. Для каждой частотной компоненты вычисляется разница амплитуд.

3. Применяется интегральный фильтр (**Integrated threshold filter**). Алгоритм интегрального фильтра следующий:


   - **Инициализация**. Начальное значение `value` устанавливается равным первому входному значению:

   $$ value = input_1 $$

   - **Расчет дельты**. Вычисляется приращение `delta`:

   $$ delta = delta + |value - input_i| * K_{int} $$

   - **Проверка порога**:

      Если `delta > threshold`, то: 

   - Обновляется значение:

   $$ value = input_i $$

   - Сбрасывается `delta`:

   $$ delta = 0 $$

   -  **Повторение процесса** — переход к шагу 2.

4. Если суммарное изменение амплитуды превышает пороговое значение (threshold), частота фиксируется как изменившаяся.

5. Пороги должны быть адаптивные, подстраивающиеся под уровень шума системы.


**4. Запись и хранение данных**
-

- Фиксируются только изменяющиеся частоты, что существенно снижает объем данных.

- Данные следует сохранять в виде: `«частота – амплитуда – временная метка»`, что упрощает дальнейший анализ.

- Система накапливает данные с возрастающим интервалом хранения:

   - **Суточное хранение** (для часто изменяющихся частот).

   - **Месячное хранение** (для менее динамичных изменений).

   - **Годовое хранение** (для редких изменений).

Такой подход позволяет фиксировать важные изменения в состоянии двигателя, обеспечивая диагностику потенциальных неисправностей без избыточного хранения.

**5. Учет переходных режимов (пуск, останов, изменение скорости вращения)**
-
Для контроля режимов работы используется датчик частоты вращения. Необходимо учитывать ключевые состояния двигателя:

- **Пуск** – резкое нарастание частоты вращения.

- **Останов** – резкое снижение частоты.

- **Стабильный режим** – частота вращения постоянна или изменяется незначительно.

- **Переходный процесс (разгон/замедление)** – плавные изменения скорости.

В переходных режимах стоит учесть адаптивную фильтрацию FFT-данных:

- Временно повышать порог чувствительности, чтобы исключить естественные изменения вибраций.
> ***Например** если в стабильном режиме threshold 1%, то в переходных режимах 5-10%*

- Корректировать анализ с учетом изменения частоты вращения, особенно при расчете амплитуд гармоник.  

>  ***Например**: Двигатель работает на 3000 об/мин → основная частота = 50 Гц. Разгон до 6000 об/мин → основная частота = 100 Гц. Вместо сравнения "50 Гц и 100 Гц" как разных событий, анализируется их как 1-я гармоника текущей скорости.*

- Исключать частоты, существующие лишь в одном или двух окнах FFT (артефакты разгона/остановки).
>  ***Пример**: Если некая частота появилась на 1 окне FFT (0.01 с) и исчезла – это, скорее всего, ложная частота. Если частота сохраняется на 5+ окнах подряд (0.05 с и дольше) – это уже значимое изменение.*

- Основной анализ следует выполнять в стабильных режимах, а в переходных учитывать только трендовый контроль вибраций.
